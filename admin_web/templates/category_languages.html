{% extends "base.html" %}
{% block content %}
<div class="container-fluid px-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/constructor">Конструктор</a></li>
            <li class="breadcrumb-item"><a href="/constructor/category/{{ category['id'] }}">Настройка {{ category['name_ru'] }}</a></li>
            <li class="breadcrumb-item active" aria-current="page">Языки</li>
        </ol>
    </nav>

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="bi bi-translate me-2"></i> Языки: {{ category['name_ru'] }}</h2>
        <div class="d-flex gap-2">
            <a href="/constructor/category/{{ category['id'] }}" class="btn btn-outline-secondary btn-round">
                <i class="bi bi-arrow-left me-1"></i> Назад
            </a>
        </div>
    </div>

    <form action="/constructor/category/{{ category['id'] }}/save_translations" method="post">
        <div class="card p-3 mb-4 bg-light border-dashed">
            <h6 class="mb-3">Переводы вопросов и кнопок (EN / VI)</h6>
            {% for step in steps %}
            <div class="border rounded-3 p-3 mb-3">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <div>
                        <div class="fw-bold small">{{ step['question_text'] }}</div>
                        <code class="x-small">{{ step['step_key'] }}</code>
                    </div>
                </div>
                <div class="row g-2">
                    <div class="col-md-6">
                        <label class="form-label">EN</label>
                        <input type="text" class="form-control" name="step_{{ step['id'] }}_en" value="{{ step['question_text_en'] or '' }}">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">VI</label>
                        <input type="text" class="form-control" name="step_{{ step['id'] }}_vi" value="{{ step['question_text_vi'] or '' }}">
                    </div>
                </div>

                {% set opts = options_by_step.get(step['id'], []) %}
                {% if opts %}
                <div class="mt-3">
                    <div class="small text-muted mb-2">Кнопки:</div>
                    {% for opt in opts %}
                    <div class="row g-2 align-items-center mb-2">
                        <div class="col-md-3">
                            <span class="badge bg-light text-dark">{{ opt['option_text'] }}</span>
                            <code class="x-small ms-1">{{ opt['option_value'] }}</code>
                        </div>
                        <div class="col-md-4">
                            <input type="text" class="form-control form-control-sm" name="opt_{{ opt['id'] }}_en" value="{{ opt['option_text_en'] or '' }}" placeholder="EN">
                        </div>
                        <div class="col-md-4">
                            <input type="text" class="form-control form-control-sm" name="opt_{{ opt['id'] }}_vi" value="{{ opt['option_text_vi'] or '' }}" placeholder="VI">
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>

        <div class="d-flex justify-content-end">
            <button type="submit" class="btn btn-primary btn-round">
                <i class="bi bi-cloud-check me-1"></i> Сохранить переводы
            </button>
        </div>
    </form>
</div>
{% endblock %}

