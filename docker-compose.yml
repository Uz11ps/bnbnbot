services:
  bot:
    build: .
    volumes:
      - ./data:/app/data
      - ./scripts:/app/scripts
      - ./staraya bd:/app/staraya bd
    env_file:
      - .env
    restart: always

  admin_web:
    build:
      context: .
      dockerfile: admin_web/Dockerfile
    ports:
      - "8000:8000"
    env_file:
      - .env
    volumes:
      - ./data:/app/data
      - ./scripts:/app/scripts
      - ./staraya bd:/app/staraya bd
      - /var/run/docker.sock:/var/run/docker.sock
    depends_on:
      - bot
    restart: always

  mtproxy:
    image: telegrammessenger/proxy:latest
    container_name: mtproxy
    restart: unless-stopped
    network_mode: host
    environment:
      - SECRET=${MTPROXY_SECRET:-}
    command: ["-u", "nobody", "-p", "8888", "--nat-info", "130.49.148.147:8888"]
    volumes:
      - ./data/mtproxy:/data
    profiles:
      - mtproxy

volumes:
  data:
